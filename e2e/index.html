
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../dev/">
      
      
        <link rel="next" href="../faq/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>üß∞ End-to-End Testing with Playwright - Frankly</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M11%209h2V7h-2m1%2013c-4.41%200-8-3.59-8-8s3.59-8%208-8%208%203.59%208%208-3.59%208-8%208m0-18A10%2010%200%200%200%202%2012a10%2010%200%200%200%2010%2010%2010%2010%200%200%200%2010-10A10%2010%200%200%200%2012%202m-1%2015h2v-6h-2z%22/%3E%3C/svg%3E');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#end-to-end-testing-with-playwright" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Frankly" class="md-header__button md-logo" aria-label="Frankly" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C6.5 3 2 6.58 2 11a7.22 7.22 0 0 0 2.75 5.5c0 .6-.42 2.17-2.75 4.5 2.37-.11 4.64-1 6.47-2.5 1.14.33 2.34.5 3.53.5 5.5 0 10-3.58 10-8s-4.5-8-10-8m0 14c-4.42 0-8-2.69-8-6s3.58-6 8-6 8 2.69 8 6-3.58 6-8 6m5-5v-2h-2v2zm-4 0v-2h-2v2zm-4 0v-2H7v2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Frankly
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üß∞ End-to-End Testing with Playwright
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/berkmancenter/frankly" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Frankly" class="md-nav__button md-logo" aria-label="Frankly" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C6.5 3 2 6.58 2 11a7.22 7.22 0 0 0 2.75 5.5c0 .6-.42 2.17-2.75 4.5 2.37-.11 4.64-1 6.47-2.5 1.14.33 2.34.5 3.53.5 5.5 0 10-3.58 10-8s-4.5-8-10-8m0 14c-4.42 0-8-2.69-8-6s3.58-6 8-6 8 2.69 8 6-3.58 6-8 6m5-5v-2h-2v2zm-4 0v-2h-2v2zm-4 0v-2H7v2z"/></svg>

    </a>
    Frankly
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/berkmancenter/frankly" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üê£ Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚öôÔ∏è Running Local Development Version
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    üß∞ End-to-End Testing with Playwright
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    üß∞ End-to-End Testing with Playwright
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-playwright" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Playwright
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-tests-locally" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests Locally
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running Tests Locally">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env" class="md-nav__link">
    <span class="md-ellipsis">
      .env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playwright-global-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Playwright Global Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Playwright Global Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env_1" class="md-nav__link">
    <span class="md-ellipsis">
      .env
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests-from-vscode" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests from VSCode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests-from-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests from Command Line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-test-results" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing Test Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#developing-playwright-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Developing Playwright Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Developing Playwright Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appdart" class="md-nav__link">
    <span class="md-ellipsis">
      app.dart
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚ùì Troubleshooting and FAQ
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-playwright" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Playwright
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-tests-locally" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests Locally
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running Tests Locally">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env" class="md-nav__link">
    <span class="md-ellipsis">
      .env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playwright-global-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Playwright Global Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Playwright Global Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env_1" class="md-nav__link">
    <span class="md-ellipsis">
      .env
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests-from-vscode" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests from VSCode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests-from-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests from Command Line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-test-results" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing Test Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#developing-playwright-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Developing Playwright Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Developing Playwright Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appdart" class="md-nav__link">
    <span class="md-ellipsis">
      app.dart
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="end-to-end-testing-with-playwright">üß∞ End-to-End Testing with Playwright</h1>
<p>This directory contains <a href="https://playwright.dev/">Playwright</a> tests for some of the product <a href="https://www.notion.so/rebootingsocialmedia/Kazm-Test-Scenarios-13896de35e1748578285ad8a80f8331d">test scenarios</a>.</p>
<h2 id="configuring-playwright">Configuring Playwright</h2>
<p>The <a href="https://playwright.dev/docs/test-configuration">Playwright configuration</a> file <code>playwright.config.ts</code> specifies, among other things, the base URL for the instance to be tested and the devices on which to test. The file is currently configured to run tests using Chromium, Firefox, and Webkit. Playwright also emulates mobile browsers and has a <a href="https://github.com/microsoft/playwright/blob/main/packages/playwright-core/src/server/deviceDescriptorsSource.json">long list of devices</a> that can be added to simulate various phone types.</p>
<h2 id="running-tests-locally">Running Tests Locally</h2>
<p>Follow these steps to set up your environment for running Playwright:</p>
<ol>
<li>Create a .env file in the e2e directory. At a minimum, this file should contain the base URL and the credentials for two accounts that can sign in to the instance you are testing using an email account. The global setup script discussed below creates a test community called ASML Testing that many of the tests use. The "Owner" account will be the owner of this acccount and the "Member" account will be a member (for role-based testing). Future roles can be configured in a similar manner as tests are added.</li>
</ol>
<p>‚ö†Ô∏è Note: The global setup script (currently <code>global.setup.ts</code>) will need to be modified to create these accounts on a clean deployment when we introduce CD. For now, it is assumed that these users are already registered.</p>
<h4 id="env"><em><code>.env</code></em></h4>
<div class="highlight"><pre><span></span><code>BASE_URL=http://localhost:5000
TEST_OWNER_USER_NAME=someone@gmail.com
TEST_OWNER_PASSWORD=heresapassword
TEST_MEMBER_USER_NAME=someonelse@gmail.com
TEST_MEMBER_PASSWORD=anotherpassword
</code></pre></div>
<ol>
<li>
<p>Run <code>npm install</code> from the e2e directory to install Playwright and its dependencies.</p>
</li>
<li>
<p>Run <code>npx playwright install</code> to install Playwright's default browsers.</p>
</li>
<li>
<p>Run firestore, functions, auth, and database emulators if testing locally.</p>
</li>
</ol>
<h3 id="playwright-global-setup">Playwright Global Setup</h3>
<p>Playwright allows you to specify global setup and teardown scripts that run once before and after an entire test suite. Our Playwright configuration file introduces a dependency on the "Setup" project, which is currently configured to match any file ending in .setup.ts. Right now, this matches <code>tests/global.setup.ts</code> This script has two important functions:</p>
<ol>
<li>If BASE_URL is not localhost, it signs in to the browser using the 'Owner' credentials, then writes the browser authentication data from local storage (and IndexedDB on Chrome) to the file <code>e2e/.auth/user.json</code> (if it does not already exist). Playwright's <a href="https://playwright.dev/docs/auth">authentication mechanism</a> reads from this file (path configured in <code>playwright.config.ts</code>) to automatically authenticate tests by repopulating test browsers with the stored state. This allows us to run tests without having to log in through the app every time. This doesn't work when running on localhost using the auth emulator, because index.html is configured to clear indexedDB on page load due to an issue with the firebase_auth library.</li>
<li>It creates the community <code>ASML Testing-[random number]</code>, which many of the tests use, and sets environment variables for test interaction. The community will not be created if the following variables are set to point to an existing community in <code>.env</code>. These values can be set to any existing community. <strong>Each developer should use a unique community URL</strong>.</li>
</ol>
<h4 id="env_1"><em><code>.env</code></em></h4>
<div class="highlight"><pre><span></span><code>TEST_COMMUNITY_NAME=&#39;ASML Testing&#39;
TEST_COMMUNITY_TAGLINE=&#39;Doing all the testing&#39;
TEST_COMMUNITY_URL=&#39;http://localhost:5000/space/1qOsSScDzRy51tvwmjKS&#39;
</code></pre></div>
<h3 id="running-tests-from-vscode">Running Tests from VSCode</h3>
<p>The Playwright extension for VSCode adds a handy testing panel that allows you to select the devices/browsers to use for text execution, as well as whether to show the browser during text execution, which is good for debugging and fun for demos. Note that the above-mentioned Global setup script will only run if the "setup" box under Projects is checked. If you have run once to generate a <code>.auth/user.json</code> file and you have the test community environment variables set to some community you want to use, you should not need to run setup.</p>
<p>From the Test Explorer or regular Explorer, you can then select one or more tests to run. Results are displayed in the "Test Results" window.</p>
<p>‚ö†Ô∏è Note: The default configuration assumes you are running the Client Dev (Emulators) profile locally prior to launching a test. The <code>.vscode/launch.json</code> file is configured to start the Flutter client on port 5000. To change the baseURL to point to another instance, simply edit the BASE_URL property in your env file.</p>
<p><img width="433" alt="Screenshot 2024-07-23 at 12 32 12‚ÄØPM" src="https://github.com/user-attachments/assets/d56ed90d-1a53-45f9-a8f9-11a93f562853"></p>
<h3 id="running-tests-from-command-line">Running Tests from Command Line</h3>
<p>You can run the entire test suite or a single test <a href="https://playwright.dev/docs/test-cli">from the command line</a> as well.</p>
<p>‚ö†Ô∏è Note: The global setup files will run once for each command line execution, but the current code is written to eliminate overhead by checking for the presence of <code>.auth/user.json</code> (when not testing localhost) and TEST_COMMUNITY environment variables in <code>.env</code></p>
<p><strong>Run all tests:</strong></p>
<div class="highlight"><pre><span></span><code><span class="gp">foo@e2e:~$ </span>npx<span class="w"> </span>playwright<span class="w"> </span><span class="nb">test</span>
</code></pre></div>
<p><strong>Run a single test file:</strong></p>
<div class="highlight"><pre><span></span><code><span class="gp">foo@e2e:~$ </span>npx<span class="w"> </span>playwright<span class="w"> </span><span class="nb">test</span><span class="w"> </span>tests/event/rsvp-event.spec.ts
</code></pre></div>
<p><strong>Run a single test within a file:</strong>
The -g command line option matches individual tests within a file by regular expression</p>
<div class="highlight"><pre><span></span><code><span class="gp">foo@e2e:~$ </span>npx<span class="w"> </span>playwright<span class="w"> </span><span class="nb">test</span><span class="w"> </span>tests/event/rsvp-event.spec.ts<span class="w"> </span>-g<span class="w"> </span><span class="s2">&quot;RSVP to a public event&quot;</span>
</code></pre></div>
<h3 id="viewing-test-results">Viewing Test Results</h3>
<p>A test report will be generated at the end of test execution and displayed in a browser. <em>Only the most recent test results are stored in the <code>test-results</code> folder</em> and can be accessed by running:</p>
<div class="highlight"><pre><span></span><code><span class="gp">foo@e2e:~$ </span>npx<span class="w"> </span>playwright<span class="w"> </span>show-report<span class="w"> </span>e2e/playwright-report
</code></pre></div>
<p>Test results are also displayed in the "Test Results" window when running in VSCode.</p>
<h3 id="parallel-execution">Parallel Execution</h3>
<p>Playwright supports <a href="https://playwright.dev/docs/test-parallel">parallel execution</a>, and the tests currently should be able to run with multiple parallel workers (individual tests should not be relying on any sort of shared state that could be modified). The workers property can be configured in <code>playwright.config.ts</code> or passed as a parameter when running from command line:</p>
<div class="highlight"><pre><span></span><code><span class="gp">foo@e2e:~$ </span>npx<span class="w"> </span>playwright<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--workers<span class="w"> </span><span class="m">4</span>
</code></pre></div>
<h2 id="developing-playwright-tests">Developing Playwright Tests</h2>
<p>It is beyond the scope of this README to provide details on how to write tests with Playwright generally. However, there are currently several things to keep in mind when creating or modifying Playwright tests specifically for our application:</p>
<ol>
<li>It is currently not possible for Playwright to identify any individual web elements in our Flutter app without enabling Flutter semantics, which creates a default Semantics tree in the DOM that allows Playwright <a href="https://playwright.dev/docs/locators">Locators</a> to find many of the elements they need to interact with. Until we properly address Semantics in the app, the test code needs to press the hidden "Enable accessibility" button on every page of our app. We use a <a href="https://playwright.dev/docs/test-fixtures">test fixture</a> defined in <code>custom-test-fixture.ts</code> to achieve this on every page load. <strong>All tests must use this fixture.</strong> Also note that this fixture contains some code for copying Playwright authentication data into IndexedDB on Chrome, as Playwright does not currently do this (see <a href="https://github.com/microsoft/playwright/issues/11164">here</a> for more information).</li>
</ol>
<p>To use the fixture, simply make sure you are importing 'test' from the correct location. Example:
<img width="638" alt="Screenshot 2024-07-24 at 9 07 31‚ÄØAM" src="https://github.com/user-attachments/assets/32d6e08e-5ab7-4a85-adbd-ca4a280fdd47"></p>
<p>Additionally, test creation can be simplified by using the Record capabilities in VSCode. However, accessibility must be enabled on the web pages for this to work as well. The easiest way to make this work is to temporarily modify the code to start with a default Semantics tree. Edit <code>client/lib/app.dart</code> as follows:</p>
<h4 id="appdart"><em><code>app.dart</code></em></h4>
<p><img width="477" alt="Screenshot 2024-07-25 at 10 25 54‚ÄØAM" src="https://github.com/user-attachments/assets/a967eaf5-a308-42c6-9902-5c53ab666016"></p>
<p>You can also trigger the hidden Enable Accessibility button by opening console in Chrome DevTools and executing <code>document.querySelector('flt-semantics-placeholder').click()</code></p>
<ol>
<li>
<p>We have adopted Playwright's recommended <a href="https://playwright.dev/docs/pom">Page Object Model</a> to encapsulate the details of locating individual UI elements. Tests should not be using Playwright <a href="https://playwright.dev/docs/locators">Locators</a> directly. Rather, each page or dialog of the app should be modeled as a page in the <code>pages</code> folder, and tests should interact directly with that model.</p>
</li>
<li>
<p><strong>There is currently no way to specify a date or time when creating an event.</strong> As a result, new events are created with today's date, and the next hour as the start time. The current event pages are coded to handle this, but <em>results may be inconsistent if there is more than one event with the same template and date.</em></p>
</li>
<li>
<p>As of now, tests must tear down anything they create. We may decide later to create more default objects like events and templates in the global setup (to reduce test execution time), but <em>care must be taken to avoid issues when running tests with parallel workers.</em> Playwright has <a href="https://playwright.dev/docs/test-parallel">some recommendations</a> for dealing with a shared state system during parallel execution.</p>
</li>
<li>
<p>Some UI elements are still not identifiable by the default Semantics tree. You may need to modify the code you are testing to add semantic labels. Many Flutter widgets have a semanticsLabel property, but if not, you can modify build methods to wrap widgets in a Semantics object as in the following example:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code>    child: Semantics(label:&#39;Submit Chat Button&#39;,button: true,
              child: ActionButton(
                minWidth: 20,
                color: context.theme.colorScheme.primary,
                controller: _sendController,
                onPressed: canSubmit ? _sendMessage : null,
                disabledColor: context.theme.colorScheme.onPrimary.withOpacity(0.3),
                height: isMobile ? 50 : 55,
                child: Icon(
                  Icons.send,
                  color: canSubmit ? context.theme.colorScheme.onPrimary : context.theme.colorScheme.onPrimaryContainer,
                ),
                ),
              ),
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "navigation.sections", "search.suggest"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>